<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>Tableau 画日历热力图 | 可视化是门手艺</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="可以在tableau public下载本次可视化的文件。 数据选用默认的超市数据的2017年整年数据，也方便大家操作。 第一步：单月的日历框架 将 订单日期 字段拖放至 列工作区，修改日期显示层级为 离散-工作日 。 生成计算字段 当月周数 DATEDIFF(&amp;#39;week&amp;#39;, DATETRUNC(&amp;#39;month&amp;#39;, [订单日期]), [订单日期])，将该字段拖放至 行功">
<meta name="keywords" content="可视化,图表技巧">
<meta property="og:type" content="article">
<meta property="og:title" content="Tableau 画日历热力图">
<meta property="og:url" content="http://yoursite.com/2019/02/17/calender_heatmap/index.html">
<meta property="og:site_name" content="可视化是门手艺">
<meta property="og:description" content="可以在tableau public下载本次可视化的文件。 数据选用默认的超市数据的2017年整年数据，也方便大家操作。 第一步：单月的日历框架 将 订单日期 字段拖放至 列工作区，修改日期显示层级为 离散-工作日 。 生成计算字段 当月周数 DATEDIFF(&amp;#39;week&amp;#39;, DATETRUNC(&amp;#39;month&amp;#39;, [订单日期]), [订单日期])，将该字段拖放至 行功">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09olhesfij30jd0cldhp.jpg">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09omklilij30e10b6q42.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/006tKfTcgy1g09ougweezj30j60bs759.jpg">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09o8f45c9j30kc0cu0v3.jpg">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09p04eawej30le0by41h.jpg">
<meta property="og:image" content="https://ws3.sinaimg.cn/large/006tKfTcgy1g09p16mm9bj30ii0akgmb.jpg">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09p7mxf8ij30ke0dgta3.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/006tKfTcgy1g09p90v0qmj30lw0bjq4d.jpg">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09pj9tl2qj30uo0hywi7.jpg">
<meta property="og:image" content="https://ws2.sinaimg.cn/large/006tKfTcgy1g09pqz9pyqj30rn0j3gsv.jpg">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09r04tb3yj30ug0icn1d.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/006tKfTcgy1g09r2epht0j30ue0dzq5x.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/006tKfTcgy1g09rmnx8owj30va0p57cg.jpg">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09rx40ebuj30kt0a2ta7.jpg">
<meta property="og:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09sid8hinj30xa0ekwij.jpg">
<meta property="og:updated_time" content="2019-02-17T14:31:13.257Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tableau 画日历热力图">
<meta name="twitter:description" content="可以在tableau public下载本次可视化的文件。 数据选用默认的超市数据的2017年整年数据，也方便大家操作。 第一步：单月的日历框架 将 订单日期 字段拖放至 列工作区，修改日期显示层级为 离散-工作日 。 生成计算字段 当月周数 DATEDIFF(&amp;#39;week&amp;#39;, DATETRUNC(&amp;#39;month&amp;#39;, [订单日期]), [订单日期])，将该字段拖放至 行功">
<meta name="twitter:image" content="https://ws4.sinaimg.cn/large/006tKfTcgy1g09olhesfij30jd0cldhp.jpg">
  
    <link rel="alternate" href="/atom.xml" title="可视化是门手艺" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">可视化是门手艺</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-calender_heatmap" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/17/calender_heatmap/" class="article-date">
  <time datetime="2019-02-17T14:23:17.000Z" itemprop="datePublished">2019-02-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tableau可视化/">Tableau可视化</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Tableau 画日历热力图
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>可以在<br><a href="https://public.tableau.com/profile/yuyang2019#!/vizhome/calender_heatmap/sheet4" target="_blank" rel="noopener">tableau public</a>下载本次可视化的文件。</p>
<p>数据选用默认的超市数据的2017年整年数据，也方便大家操作。</p>
<h2 id="第一步：单月的日历框架"><a href="#第一步：单月的日历框架" class="headerlink" title="第一步：单月的日历框架"></a>第一步：单月的日历框架</h2><ol>
<li>将 <em>订单日期</em> 字段拖放至 <em>列工作区</em>，修改日期<a href="https://onlinehelp.tableau.com/current/pro/desktop/zh-cn/dates_levels.htm" target="_blank" rel="noopener">显示层级</a>为 <em>离散-工作日</em> 。</li>
<li><p>生成计算字段 <em>当月周数</em> <code>DATEDIFF(&#39;week&#39;, DATETRUNC(&#39;month&#39;, [订单日期]), [订单日期])</code>，将该字段拖放至 <em>行功能区</em>，修改字段类型为 <em>维度</em> <em>离散</em> 。<br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g09olhesfij30jd0cldhp.jpg" alt=""></p>
</li>
<li><p>右击 <em>当月周数</em> 字段标题，取消勾选 <em>显示标题</em><br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g09omklilij30e10b6q42.jpg" alt=""></p>
</li>
<li><p>将 <em>订单日期</em> 字段拖放至 <em>筛选器</em> ，通过 <em>离散-年/月</em> 筛选，选择一个月</p>
</li>
<li>将 <em>销售额</em> 字段拖放至 <em>颜色标记卡</em></li>
<li>将 <em>订单日期</em> 字段拖放至 <em>标签标记卡</em>，修改日期显示层级为 <em>离散-天</em></li>
<li>修改图表类型为 <em>方形</em></li>
</ol>
<p><strong>第一步效果</strong></p>
<p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g09ougweezj30j60bs759.jpg" alt=""></p>
<p>我们实现了一个月的日历框架。</p>
<p>注意我们这设置行列关系使用的都是通过 <em>离散字段</em> 生成的 <em>标题</em>，也就是在工作区中，目前所有的字段都是 <em>蓝色</em> 状态，包括我们在使用筛选器，修改日期显示层级都选择的是离散。</p>
<p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g09o8f45c9j30kc0cu0v3.jpg" alt=""></p>
<p>如果 “蓝色” 和 “绿色” 字段的区别，可以看看官方教程 <a href="https://onlinehelp.tableau.com/current/pro/desktop/zh-cn/datafields_typesandroles.htm" target="_blank" rel="noopener">维度和度量（蓝色和绿色）</a>。</p>
<h2 id="第二步：调整显示效果"><a href="#第二步：调整显示效果" class="headerlink" title="第二步：调整显示效果"></a>第二步：调整显示效果</h2><ol>
<li><p>将英文星期标题显示修改为缩写<br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g09p04eawej30le0by41h.jpg" alt=""><br><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g09p16mm9bj30ii0akgmb.jpg" alt=""></p>
</li>
<li><p>将图表类型修改为 <em>圆形</em>，调整标签的对齐方式 <em>上下居中</em> <em>左右居中</em><br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g09p7mxf8ij30ke0dgta3.jpg" alt=""></p>
</li>
</ol>
<p><strong>第二步效果</strong></p>
<p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g09p90v0qmj30lw0bjq4d.jpg" alt=""></p>
<p>这一步选择了 <em>圆</em> 的图表类型，当然也可以尝试方形，甚至六边形。<br>到了这一步其实已经基本完成了日历热力图的画法了，剩下的工作只是多个月份的排版。</p>
<h2 id="第三步：全年排版"><a href="#第三步：全年排版" class="headerlink" title="第三步：全年排版"></a>第三步：全年排版</h2><ol>
<li>删除月份筛选器</li>
<li>生成字段 <em>月份所在列</em> ,将该字段拖放到维度数据面板，再将该字段拖放至 <em>列功能区</em>。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">CASE MONTH([订单日期])</span><br><span class="line">WHEN 1 THEN 1</span><br><span class="line">WHEN 2 THEN 2</span><br><span class="line">WHEN 3 THEN 3</span><br><span class="line">WHEN 4 THEN 1</span><br><span class="line">WHEN 5 THEN 2</span><br><span class="line">WHEN 6 THEN 3</span><br><span class="line">WHEN 7 THEN 1</span><br><span class="line">WHEN 8 THEN 2</span><br><span class="line">WHEN 9 THEN 3</span><br><span class="line">WHEN 10 THEN 1</span><br><span class="line">WHEN 11 THEN 2</span><br><span class="line">WHEN 12 THEN 3</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g09pj9tl2qj30uo0hywi7.jpg" alt=""></p>
<ol start="3">
<li>将 <em>订单日期</em> 拖放至 <em>列功能区</em>，调整日期显示层级为 <em>离散-季度</em></li>
<li>将 <em>第三步</em> 中生成的两个字段，在图中的标题隐藏掉，方法同第一步.3</li>
</ol>
<p><strong>第三步效果</strong></p>
<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g09pqz9pyqj30rn0j3gsv.jpg" alt=""></p>
<p>现在需要把月份的名称显示出来，步骤有点多，再添加一步。</p>
<h2 id="第四步：添加月份标签"><a href="#第四步：添加月份标签" class="headerlink" title="第四步：添加月份标签"></a>第四步：添加月份标签</h2><ol>
<li>为了添加月份标签，需要用到双轴功能，所以 <em>当月周数</em> 字段会调整成 连续字段，将 <em>当月周数</em> 坐标轴反向。</li>
<li>生成一个计算字段 <em>筛选周四</em>，用来标记周四的位置，在周四上方添加月份信息。<code>IF  DATEPART(&#39;weekday&#39;, [订单日期]) = 4 then -1.5 END</code></li>
<li>将 <em>筛选周四</em> 字段拖放至 <em>行功能区</em>，调整度量方式为 <em>求平均值</em>。</li>
<li>对 <em>筛选周四</em> 字段进行，<em>双轴-同步轴</em>  操作。<img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g09r04tb3yj30ug0icn1d.jpg" alt=""></li>
<li>调整 <em>平均值(筛选周四)</em> 字段的 标记卡。将图表类型 从 <em>圆</em> -&gt; <em>文本</em> ，删除 <em>颜色标记卡</em>，将 <em>订单日期</em> 字段的显示层级修改为 <em>离散-月份</em>。<br><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g09r2epht0j30ue0dzq5x.jpg" alt=""></li>
<li>删除网格线，增加背景区分</li>
</ol>
<p><strong>最终效果</strong></p>
<p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g09rmnx8owj30va0p57cg.jpg" alt=""></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g09rx40ebuj30kt0a2ta7.jpg" alt=""></p>
<p>其实画日历就是在折腾不同的 <em>维度</em> 来控制 <em>标题</em> 在不同的 行列中出现，通过折腾 <em>度量</em> 来控制坐标轴，从而控制数值显示内容。</p>
<p>这里还是要再强调一下熟悉一下基本的 <a href="https://onlinehelp.tableau.com/current/pro/desktop/zh-cn/datafields_typesandroles.htm" target="_blank" rel="noopener">蓝色与绿色</a> 功能上的差异，其实这也是这次教程的最重要的额外收获。</p>
<p>最后回顾一下基本的步骤：</p>
<ol>
<li>生成一个月的日历</li>
<li>通过外层增加控制字段，生成全年的日历</li>
</ol>
<p>我个人至少学习到了：</p>
<ol>
<li>将星期的显示方式修改为缩写</li>
<li>通过双轴来设置一个子图的标签</li>
<li>通过背景颜色 增强 子图之间的区隔</li>
</ol>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.tableau.com/about/blog/2017/2/viz-variety-show-heatmaps-66330" target="_blank" rel="noopener">Viz Variety Show: When to use heatmap calendars</a></p>
<p><a href="http://www.vizwiz.com/2017/03/how-to-heatmap-calendar.html" target="_blank" rel="noopener">VizWiz</a></p>
<p>照常在博客更新一下，有更清晰的图片，方便的导航，希望能够方便你使用。有机会也会开一个微信公众号，方便手机端的阅读。<br><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1g09sid8hinj30xa0ekwij.jpg" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/02/17/calender_heatmap/" data-id="ck294fhh2000457c9jz4mpwjo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/可视化/">可视化</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图表技巧/">图表技巧</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/02/18/MM-2019W07/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          2019-W07 图表挑战总结
        
      </div>
    </a>
  
  
    <a href="/2019/02/17/[tableau_tip]round_bar_plot/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Tableau画圆角条形图</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Tableau可视化/">Tableau可视化</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据准备/">数据准备</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/TC18/">TC18</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tableau-Prep/">Tableau Prep</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/可视化/">可视化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图表技巧/">图表技巧</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图表挑战/">图表挑战</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/TC18/" style="font-size: 10px;">TC18</a> <a href="/tags/Tableau-Prep/" style="font-size: 10px;">Tableau Prep</a> <a href="/tags/可视化/" style="font-size: 20px;">可视化</a> <a href="/tags/图表技巧/" style="font-size: 16.67px;">图表技巧</a> <a href="/tags/图表挑战/" style="font-size: 13.33px;">图表挑战</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/02/18/MM-2019W07/">2019-W07 图表挑战总结</a>
          </li>
        
          <li>
            <a href="/2019/02/17/calender_heatmap/">Tableau 画日历热力图</a>
          </li>
        
          <li>
            <a href="/2019/02/17/[tableau_tip]round_bar_plot/">Tableau画圆角条形图</a>
          </li>
        
          <li>
            <a href="/2019/02/09/tc-用Tableau-Prep的方式准备数据/">用Tableau_Prep的方式准备数据「TC18」【一起看TC】</a>
          </li>
        
          <li>
            <a href="/2019/02/07/mm-19w05-雷达图/">在Tableau中画雷达图【图表挑战】</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 禹洋<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>